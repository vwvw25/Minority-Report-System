# UI Workshop Notes — Minority Report System  
**File:** `ui_workshop_notes.md`  
**Last Updated:** 2025-10-10  

---

## 1. Purpose  
The Minority Report UI provides the **human-in-the-loop layer** of the system.  
It allows analysts and decision-makers to monitor, investigate, and finalise anomaly reports generated by the log-driven pipeline.  

The UI is designed for:  
- **Analysts** (e.g. Lewis, Kayla) investigating and validating model outputs.  
- **Managers** (e.g. Joseph) communicating model insights to stakeholders.  
- **Governance and audit** — all edits, approvals, and comments are written to logs and can be replayed deterministically.  

---

## 2. Concept Overview  

The interface mirrors the system’s architecture:
| Layer | UI Element | Backed by |
|-------|-------------|-----------|
| Detection | Anomaly map + severity summary | `minority_reports_detected_log` |
| Clustering | UMAP/cluster scatterplot | `minority_reports_clustered_log` |
| Cohorting | Event cards & timelines | `minority_reports_cohorted_log` |
| Attribution | Proposed cause + confidence | `minority_reports_proposed_attribution_log` |
| Finalisation | Approval panel | `ui_edits_log` → `minority_reports_finalised_log` |

All screens are **read-from-log** and **write-to-log** — no state is stored in the UI itself.  

---

## 3. Core User Flows  

### 3.1 Lewis — Investigate and Approve  

Lewis receives an alert for a Minority Event with **severity 0.95**.  
He clicks the link and opens the **Minority Event screen**, which shows:  
- **Time-series chart** — orange line (actual sales) vs. green baseline (expected).  
- **Summary cards** — total uplift, total sales, and event window.  
- **Proposed causes** — attribution model suggestions with confidence scores.  
- **Cluster scatter** — UMAP projection showing where this event sits relative to learned clusters.  

Lewis can now:  
- **Approve the report** (writes to `ui_edits_log` with `action=approve`).  
- **Add evidence** (e.g. TV clip, stored in `supporting_evidence` in MRFL).  
- **Edit cause/category** (e.g. change from *Google Ads* → *TikTok Viral*).  
- **Request review** (sends report to data team queue).  
- **Defer action** and return once more data accumulates.  

All actions are captured as immutable log entries. When finalised, `build_minority_reports_finalised_log_from_edits.py` replays these logs and publishes authoritative rows to MRFL.

---

### 3.2 Kayla — Monitor and Filter  

Kayla uses the **All Reports screen**.  
At the top, four KPI cards show:  
- **Anomalies detected** (past 7 days)  
- **Minority events**  
- **Auto-attribution rate**  
- **Protected spend**  

By default, the table lists **unapproved** reports.  
Kayla filters by *retailer = Waitrose*, *status = active*, *proposed cause = data error*.  
Each row links to the **Report Detail view**, which includes:  
- Time-series view (actual vs. baseline).  
- Proposed causes and confidence.  
- Cluster position on UMAP.  
- Breakdown tab showing all feature data.  

Kayla interacts with **Tom**, the integrated AIP assistant, to query the system in natural language:  
> “Was the Waitrose till error detected this week?”  
Tom checks the logs and replies that it was — confidence > 70%, weekend mode, auto-approved.  
This dialogue is logged as an assistive query, providing transparency for all AI interactions.  

---

### 3.3 Joseph — Present and Explain  

Joseph uses the system during a **board presentation**.  
He filters the All Reports map to one Minority Event: a national spike linked to an influencer campaign.  
Bubbles bloom across the UK map as the event’s local reports render.  
He explains:  
- The **orange line** = real sales.  
- The **green line** = expected baseline.  
- **£ uplift cards** quantify incremental performance.  

The system helps demonstrate **marketing efficiency** — preventing double-counting of organic spikes as paid success.  
Joseph uses it to communicate both the AI’s analytical power and its governance integrity.

---

## 4. Data Bindings  

| UI Action | Dataset Written | Transform Consuming |
|------------|----------------|---------------------|
| Approve / Edit / Add Evidence | `ui_edits_log` | `build_minority_reports_finalised_log_from_edits.py` |
| Request Review | `ui_edits_log` (flagged `needs_review=true`) | Governance / Rereview queue |
| Assistant Query (Tom) | `ui_assistant_log` | Optional analytics on query patterns |
| Map / Filter Interaction | None (read-only) | — |

---

## 5. Auto-Approval and Governance  

Auto-approval is a **governance-gated capability**:  
- Initially disabled; requires human validation.  
- Once confidence thresholds and uptime metrics are met, selected high-confidence weekend reports can auto-approve.  
- All auto-approvals are still logged to `ui_edits_log` with `user_role='system'`.  

This behaviour is also documented under *governance_hooks.md → Automated Decision Controls*.  

---

## 6. Design Philosophy  

- **Narrative alignment** — mirrors real investigative reasoning: detect → cluster → attribute → confirm.  
- **Explainability** — every chart, table, and decision ties to a logged dataset.  
- **No silent actions** — even assistant queries write to logs.  
- **Human-in-the-loop by default** — automation can increase only once system accuracy is proven.  
- **Aesthetic parity** — UI matches Palantir design language: map-centric, data-dense, calm dark theme.  

---

## 7. Example Interaction Transcript  

**Lewis:** (approves report)  
→ `ui_edits_log` entry: `{ action: 'approve', report_id: 'MR-733415514a8b', actor: 'Lewis', timestamp: '2025-08-11T20:31Z' }`  

**Kayla:** (adds evidence)  
→ `ui_edits_log` entry: `{ action: 'edit', field: 'supporting_evidence', value: 'https://video.link/tv-mention', actor: 'Kayla' }`  

**Tom (AIP Assistant):** “Report ME-97430e8bf599 was auto-approved under weekend mode. Confidence 73%.”  

---

## 8. Future Enhancements  

- Multi-user annotation and review queue.  
- Direct model feedback loop from edits to retraining pipeline.  
- AI-assisted clustering explanations (“this cluster is characterised by weekday spikes and Gen-Z demographics”).  
- Extended provenance overlay to show *which dataset each insight came from*.  

---

## 9. Summary  

The UI binds Palantir-style operational clarity with data-science explainability.  
Every interaction, approval, and query reinforces the system’s **log-driven, stateless, reproducible** design philosophy.  
The result is a **narrative-first interface** that makes AI decisions transparent, contestable, and human-auditable.

---
